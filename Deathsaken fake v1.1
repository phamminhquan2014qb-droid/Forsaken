--[[  
    üíÄ Deathsaken Hub v1.1 Full + Aimbot + ESP  
    by ngkhai & yukiquan  
    Discord: dsc.gg/Deathsaken  
]]  

-- ‚öôÔ∏è Load Rayfield
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- ü™© Window Settings
local Window = Rayfield:CreateWindow({  
    Name = "Deathsaken",  
    Icon = 18760709024,  
    LoadingTitle = "Loading Deathsaken...",  
    LoadingSubtitle = "by ngkhai and yukiquan",  
    ShowText = "deathsaken",  
    Theme = "Default",  
    ToggleUIKeybind = "K",  
    DisableRayfieldPrompts = false,  
    DisableBuildWarnings = false,  
    ConfigurationSaving = {  
        Enabled = true,  
        FolderName = "DeathsakenHub",  
        FileName = "Deathsaken Hub"  
    },  
    Discord = {  
        Enabled = true,  
        Invite = "dsc.gg/Deathsaken",  
        RememberJoins = true  
    },  
    KeySystem = true,  
    KeySettings = {  
        Title = "Deathsaken Key-System",  
        Subtitle = "Deathsaken Key System",  
        Note = "(dsc.gg/Deathsaken) - Join our discord right now",  
        FileName = "Deathsakenkey",  
        SaveKey = true,  
        GrabKeyFromSite = false,  
        Key = {"1000MEMBERS", "yukiquan", "SIGMASAKEN", "deathsaken", "guests", "Ngkhai", "forsaken"}  
    }  
})

-- üß± Tabs
local Main = Window:CreateTab("Main", 4483362458)  
local Combat = Window:CreateTab("Combat", 4483362458)  
local Visual = Window:CreateTab("Visuals", 4483362458)  
local Miscs = Window:CreateTab("Misc", 4483362458)  
local AntiSlows = Window:CreateTab("Anti-Slows", 4483362458)
local Aimbot = Window:CreateTab("Aimbot", 4483362458)

-- Services
local Players = game:GetService("Players")
local lp = Players.LocalPlayer
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local workspacePlayers = workspace:WaitForChild("Players")
local Survivors = workspacePlayers:WaitForChild("Survivors")
local KillersFolder = workspacePlayers:WaitForChild("Killers")
local RemoteEvent = ReplicatedStorage:WaitForChild("Modules"):WaitForChild("Network"):WaitForChild("RemoteEvent")

-- ====================================
-- TAB: VISUALS - Full ESP Integration
-- ====================================
Visual:CreateSection("ESP Toggles")
local killersESPToggle, survivorsESPToggle, itemESPEnabled, generatorESPEnabled = false,false,false,false
local dispenserESPEnabled, sentryESPEnabled, tripwareESPEnabled = false,false,false

-- Killers ESP Toggle
Visual:CreateToggle({
    Name = "Killers ESP",
    CurrentValue = false,
    Flag = "KillersESP",
    Callback = function(Value)
        killersESPToggle = Value
    end,
})
-- Survivors ESP Toggle
Visual:CreateToggle({
    Name = "Survivors ESP",
    CurrentValue = false,
    Flag = "SurvivorsESP",
    Callback = function(Value)
        survivorsESPToggle = Value
    end,
})
-- Items ESP Toggle
Visual:CreateToggle({
    Name = "Items ESP",
    CurrentValue = false,
    Flag = "ItemsESP",
    Callback = function(Value)
        itemESPEnabled = Value
        if itemESPEnabled then enableItemESP() else disableItemESP() end
    end,
})
-- Generators ESP Toggle
Visual:CreateToggle({
    Name = "Generators ESP",
    CurrentValue = false,
    Flag = "GeneratorsESP",
    Callback = function(Value)
        generatorESPEnabled = Value
        if Value then startGeneratorESP() else stopGeneratorESP() end
    end,
})
-- Dispenser ESP Toggle
Visual:CreateToggle({
    Name = "Dispenser ESP",
    CurrentValue = false,
    Flag = "DispenserESP",
    Callback = function(Value)
        _G.DispenserESPEnabled = Value
    end,
})
-- Sentry ESP Toggle
Visual:CreateToggle({
    Name = "Sentry ESP",
    CurrentValue = false,
    Flag = "SentryESP",
    Callback = function(Value)
        _G.SentryESPEnabled = Value
    end,
})
-- Tripware/Subspace ESP Toggle
Visual:CreateToggle({
    Name = "Tripware ESP",
    CurrentValue = false,
    Flag = "TripwareESP",
    Callback = function(Value)
        _G.CustomESP_TripwareEnabled = Value
    end,
})

-- ===============================
-- ESP Functions (Paste all ESP logic here)
-- attachBillboard, updateBillboardText, Fake Noli check
-- Generator ESP (progress bars + BoxHandleAdornment)
-- Item ESP (Box+NameTag)
-- Dispenser/Sentry/Tripware ESP
-- ===============================

-- RunService.RenderStepped updates
RunService.RenderStepped:Connect(function()
    -- Update all ESP toggles
    for _, folderData in pairs({
        {folder = KillersFolder, toggle = killersESPToggle},
        {folder = Survivors, toggle = survivorsESPToggle},
    }) do
        for _, model in ipairs(folderData.folder:GetChildren()) do
            local bb = model:FindFirstChild("ESP_NameBillboard")
            local hl = model:FindFirstChild("ESP_Highlight")
            if bb then bb.Enabled = folderData.toggle end
            if hl then hl.Enabled = folderData.toggle end
            if folderData.toggle and bb and bb.Adornee then
                local dist = (workspace.CurrentCamera.CFrame.Position - bb.Adornee.Position).Magnitude
                local scale = math.clamp(1/(dist/20),0.5,2)
                local label = bb:FindFirstChild("NameLabel")
                if label then
                    label.TextSize = math.clamp(10*scale,12,20)
                    bb.Size = UDim2.new(0,label.TextBounds.X+20,0,50*scale)
                end
            end
        end
    end
end)

-- ===============================
-- Main/Combat/AntiSlows/Aimbot tabs remain unchanged
-- Paste your existing code for them here
-- ===============================

-- ===============================
-- Notify Loaded
-- ===============================
Rayfield:Notify({
    Title = "Deathsaken Loaded",
    Content = "Welcome, " .. lp.Name .. " üíÄ",
    Duration = 5
})
